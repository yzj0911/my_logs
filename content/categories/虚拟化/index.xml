<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>虚拟化 - 分类 - lack 的个人博客</title>
        <link>http://xingyys.tech/categories/%E8%99%9A%E6%8B%9F%E5%8C%96/</link>
        <description>虚拟化 - 分类 - lack 的个人博客</description>
        <generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Sun, 31 Jan 2021 10:38:28 &#43;0800</lastBuildDate><atom:link href="http://xingyys.tech/categories/%E8%99%9A%E6%8B%9F%E5%8C%96/" rel="self" type="application/rss+xml" /><item>
    <title>KVM镜像管理工具libguestfs</title>
    <link>http://xingyys.tech/posts/kvm/libguestfs/</link>
    <pubDate>Sun, 31 Jan 2021 10:38:28 &#43;0800</pubDate><author>
        <name>Lack</name>
    </author><guid>http://xingyys.tech/posts/kvm/libguestfs/</guid>
    <description><![CDATA[简介 libguestfs 是一套管理虚拟机镜像的工具。它提供以一系列命令和API来修改和管理虚拟机的镜像。
安装 直接使用 yum 安装 libguestfs :
yum install -y libguestfs-tool libguestfs-devel 默认不支持修改 windows 镜像，可以安装 libguestfs-winsupport :
yum install -y libguestfs-winsupport libguestfs 命令 libguestfs 的通用参数
 -a|&ndash;add image : 指定查看的镜像文件路径 -c|&ndash;connect uri : 指定远程 libvirt 地址 -d|&ndash;domain guest : 指定 libvirt 上的 domain 名称   注: libguestfs 的命令需要调用 libvirt 所以响应的速度会比较慢。同时，如果命令会修改镜像的内容，需要先关闭域，避免造成数据不同步。
 virt-inspector virt-inspector 命令用来查看镜像信息，输出格式为 xml
$ virt-inspector -d centos &lt;?xml version=&#34;1.0&#34;?&gt; &lt;operatingsystems&gt; &lt;operatingsystem&gt; &lt;root&gt;/dev/centos/root&lt;/root&gt; &lt;name&gt;linux&lt;/name&gt; &lt;arch&gt;x86_64&lt;/arch&gt; &lt;distro&gt;centos&lt;/distro&gt; &lt;product_name&gt;CentOS Linux release 7.]]></description>
</item><item>
    <title>qemu-img命令使用</title>
    <link>http://xingyys.tech/posts/kvm/qemu-img%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8/</link>
    <pubDate>Sun, 17 Jan 2021 22:35:06 &#43;0800</pubDate><author>
        <name>Lack</name>
    </author><guid>http://xingyys.tech/posts/kvm/qemu-img%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8/</guid>
    <description><![CDATA[qemu-img 是 QEMU 的磁盘管理工具，它允许用户创建、转化、修改 QEMU 磁盘。
 注：qemu-img 操作磁盘时需要关闭 kvm 虚拟机，直接在虚拟机运行时修改磁盘可能会导致数据不一致甚至导致磁盘损坏。
 qemu-img 基本命令 check 语法: check [-f fmt] filename
对磁盘镜像文件进行一致性检查，查找镜像文件中的错误，目前仅支持对“qcow2”、“qed”、“vdi”格式文件的检查。其中，qcow2 是 QEMU 0.8.3版本引入的镜像文件格式，也是目前使用最广泛的格式。qed（QEMU enhanced disk）是从 QEMU 0.14 版开始加入的增强磁盘文件格式，为了避免 qcow2 格式的一些缺点，也为了提高性能，不过目前还不够成熟。而 vdi（Virtual Disk Image）是 Oracle 的 VirtualBox 虚拟机中的存储格式。参数-f fmt 是指定文件的格式，如果不指定格式 qemu-img 会自动检测，filename 是磁盘镜像文件的名称（包括路径）。
# qemu-img check -f qcow2 sdb.qcow2 No errors were found on the image. Image end offset: 524288 create 语法: create [-f fmt] [-o options] filename [size]
创建一个格式为 fmt，大小为 size，文件名为filename 的镜像文件。根据文件格式 fmt 的不同，还可以添加一个或多个选项（options）来附加对该文件的各种功能设置，可以使用“-o ?]]></description>
</item><item>
    <title>KVM之虚拟机管理</title>
    <link>http://xingyys.tech/posts/kvm/kvm_vm/</link>
    <pubDate>Wed, 06 Jan 2021 22:58:06 &#43;0800</pubDate><author>
        <name>Lack</name>
    </author><guid>http://xingyys.tech/posts/kvm/kvm_vm/</guid>
    <description><![CDATA[本篇文章介绍 KVM 虚拟机的管理，包括虚拟机的创建、修改、启动、删除等内容
 安装虚拟机 使用 virt-install 安装 virt-install 是一个命令行工具，专门用于安装 kvm 虚拟机。执行以下命令：
virt-install \  --name centos \  --ram 1024 \  --disk path=/data/kvm/centos.img,size=20 \  --vcpus 1 \  --os-type linux --os-variant rhel7 \  --network bridge=br0 \  --graphics vnc,listen=0.0.0.0,port=5999 --noautoconsole \  --console pty,target_type=serial \  --cdrom CentOS-7-x86_64-DVD-1810.iso 进入安装流程：
# virsh list --all Id 名称 状态 ---------------------------------------------------- 2 centos running 可以使用 vnc 客户端连接虚拟机。
参数说明：
 -–name 指定虚拟机的名字 –-ram 指定内存分配多少 –-disk path 指定虚拟磁盘放到哪里，size=30 指定磁盘大小为30G,这样磁盘文件格式为raw，raw格式不能做快照，后面有说明，需要转换为qcow2格式，如果要使用qcow2格式的虚拟磁盘，需要事先创建qcow2格式的虚拟磁盘。 参考 http://www.]]></description>
</item><item>
    <title>KVM介绍</title>
    <link>http://xingyys.tech/posts/kvm/kvm_detail/</link>
    <pubDate>Mon, 04 Jan 2021 22:45:23 &#43;0800</pubDate><author>
        <name>Lack</name>
    </author><guid>http://xingyys.tech/posts/kvm/kvm_detail/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="https://raw.githubusercontent.com/xingyys/myblog/main/posts/images/20210104230407.png" referrerpolicy="no-referrer">
            </div>KVM 概述 KVM (Kernal-base Virtual Machine) 基于内核的虚拟机。是一种通过修改 linux 内核实现虚拟化功能的半虚拟化技术。由于是在内核基础上运行，所有具有接近物理机的高性能。
KVM 和 Qemu Qemu（quick emulator）开源的软件虚拟化实现，通过软件来模拟硬件的功能，但缺点是性能低。通过和 KVM 相结合来提高性能。现在的版本已经内置 KVM。
全虚拟化和半虚拟化 全虚拟化是指不需要修改操作系统内核实现虚拟化功能，半虚拟化则需要修改内核来实现虚拟化。
KVM 就是一种半虚拟化实现。
全虚拟化又分为软件全虚拟化 (Qemu) 和硬件全虚拟化(Xen)。
KVM 工具集合  libvirt：操作和管理KVM虚机的虚拟化 API，使用 C 语言编写，可以由 Python,Ruby, Perl, PHP, Java 等语言调用。可以操作包括 KVM，vmware，XEN，Hyper-v, LXC 等在内的多种 Hypervisor。 Virsh：基于 libvirt 的 命令行工具 （CLI） Virt-Manager：基于 libvirt 的 GUI 工具 virt-v2v：虚机格式迁移工具 virt-* 工具：包括 Virt-install （创建KVM虚机的命令行工具）， Virt-viewer （连接到虚机屏幕的工具），Virt-clone（虚机克隆工具），virt-top 等 sVirt：安全工具  KVM 文章  KVM介绍 KVM源码分析  ]]></description>
</item><item>
    <title>CentOS7 安装 qemu-5.2.0</title>
    <link>http://xingyys.tech/posts/kvm/centos7_install_qemu/</link>
    <pubDate>Sun, 27 Dec 2020 22:22:25 &#43;0800</pubDate><author>
        <name>Lack</name>
    </author><guid>http://xingyys.tech/posts/kvm/centos7_install_qemu/</guid>
    <description><![CDATA[本文介绍在 CentOS7.9 上编译安装 qemu-5.2.0
安装 Python3 编译安装 qemu-5.2.0 依赖 Python3.6 及以上的版本。所以首先安装 Python3.6。这里选择编译安装。
下载 Python3.6.12 从 Python 官网下载 Python3.6.12 源码包：
wget https://www.python.org/ftp/python/3.6.12/Python-3.6.12.tar.xz 解压 tar -xvf Python-3.6.12.tar.gz 安装 openssl pip 下载是需要 ssl 支持，所以下载 openssl
yum install -y openssl openssl-devel zlib-devel bzip2-devel bzip2 编译安装 cd Python-3.6.12 ./configure --prefix=/usr/local/python3 --enable-optimizations make -j8 build_all &amp;&amp; make -j8 install 设置软链接 ln -s /usr/local/python3/bin/python3 /usr/bin/python3 ln -s /usr/local/python3/bin/pip3 /usr/bin/pip3 验证 # python3 Python 3.6.12 (default, Dec 27 2020, 07:52:33) [GCC 4.]]></description>
</item><item>
    <title>CentOS下kvm安装</title>
    <link>http://xingyys.tech/posts/kvm/centos%E4%B8%8Bkvm%E5%AE%89%E8%A3%85/</link>
    <pubDate>Sat, 30 Jun 2018 16:16:02 &#43;0000</pubDate><author>
        <name>作者</name>
    </author><guid>http://xingyys.tech/posts/kvm/centos%E4%B8%8Bkvm%E5%AE%89%E8%A3%85/</guid>
    <description><![CDATA[注：运行kvm保证机器支持虚拟化且在bios中开启。
 准备工作 清除iptables规则 # CentOS6 service iptables stop; service iptables save # CentOS7 systemctl stop firewalld 关闭selinux sed -i &#39;s/SELINUX=enforcing/SELINUX=disabled/&#39; /etc/selinux/config setenforce 0 检测系统是否支持虚拟化 grep -Ei &#39;vmx|svm&#39; /proc/cpuinfo 如果有输出内容，则支持，其中intel cpu支持会有vmx，amd cpu支持会有svm
安装 执行安装命令 yum install -y kvm virt-* libvirt bridge-utils qemu-img 说明：
 kvm:软件包中含有KVM内核模块，它在默认linux内核中提供kvm管理程序 libvirt:安装虚拟机管理工具，使用virsh等命令来管理和控制虚拟机。 bridge-utils:设置网络网卡桥接。 virt-*:创建、克隆虚拟机命令，以及图形化管理工具virt-manager qemu-img:安装qemu组件，使用qemu命令来创建磁盘等。  检查kvm模块是否加载 lsmod |grep kvm 结果输出：
kvm_intel 55496 3 kvm 337772 1 kvm_intel 如果没有，需要执行，还没有就重启一下试试
modprobe kvm-intel 配置网卡 cd /etc/sysconfig/network-scripts/ cp ifcfg-eth0 ifcfg-br0 编辑eth0]]></description>
</item></channel>
</rss>
